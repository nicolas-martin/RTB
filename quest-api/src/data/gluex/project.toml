[project]
id = "gluex"
name = "GlueX"
description = "GlueX DEX quests"
graphqlEndpoint = "https://api.goldsky.com/api/public/project_cmfy6mw327h2401xm82q555dj/subgraphs/gluex/2.0.3/gn"

[[transaction]]
name = "swaps_usdt0"
query = """
query UserSwapsUSDT0($user: ID!) {
  swaps(
    where: {user_: {id: $user}, inputToken: "0xb8ce59fc3717ada4c02eadf9682a9e934f625ebb"}
    orderBy: timestamp
    orderDirection: desc
  ) {
    timestamp
    inputAmount
    inputToken
    outputToken
    finalOutputAmount
    transactionHash
  }
}
"""

[[quest]]
id = "swap_1_usdt0_to_xpl"
title = "Swap 1 USDT0 to XPL"
description = "Swap 1 or more USDT0 to XPL"
reward = 500
type = "conditional"
query = """
 query SwapUSDT0ToXPL($userAddress: ID!) {
   swaps(
     where: {
       userAddress: $userAddress,
       inputToken: "0xb8ce59fc3717ada4c02eadf9682a9e934f625ebb",
       outputToken: "0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",
       inputAmount_gte: "1000000"
     }
   ) {
     timestamp
     userAddress
     inputAmount
   }
 }
 """

[[quest.conditions]]
field = "len(swaps)"
operator = ">="
value = 1

[[quest]]
id = "swap_volume_usdt0_20"
title = "Swap TotalVolume of USDT0 All time ≥ 20"
description = "Trade 20 or more USDT0 all time"
reward = 1500
type = "progress"
query = """
 query UserVolumeUSDT0($userAddress: ID!) {
   user(id: $userAddress) {
     tokenVolumes(where: {token: "0xb8ce59fc3717ada4c02eadf9682a9e934f625ebb"}) {
       token
       totalVolume
     }
   }
 }
 """

[[quest.conditions]]
field = "user.tokenVolumes[0].totalVolume"
operator = ">="
value = 20000000

[[quest]]
id = "total_value_traded_100_usdt0"
title = "Swap Total amount traded value ≥100 USDT0 in all tokens all time"
description = "Trade any token with a value more than 100 USDT0 all time"
reward = 10000
type = "custom(100)"
query = """
 query UserTotalVolume($userAddress: ID!) {
   user(id: $userAddress) {
     tokenVolumes {
       token
       totalVolume
     }
   }
 }
 """

[[quest]]
id = "volume_10_usdt0_24h"
title = "Total Volume traded ≥ 10 USDT0 in value in the last 24 hours"
description = "Trade any token with a value of at least 10 USDT0 in the last 24 hours"
reward = 2000
type = "custom(10)"
query = """
 query UserSwaps24h($userAddress: ID!, $timestamp24hAgo: String!) {
   swaps(
     where: {
       userAddress: $userAddress,
       timestamp_gt: $timestamp24hAgo
     }
   ) {
     timestamp
     inputAmount
     inputToken
   }
 }
 """

[[quest.variables]]
timestamp24hAgo = "getTimestamp24hAgo"

[[quest]]
id = "total_10_swaps"
title = "Do a total of at least 10 swaps"
description = "Any token, any value"
reward = 500
type = "progress"
query = """
query UserTotalSwaps($userAddress: ID!) {
  swaps(
    where: {userAddress: $userAddress}
  ) {
    timestamp
    inputAmount
    inputToken
  }
}
"""

[[quest.conditions]]
field = "len(swaps)"
operator = ">="
value = 10
