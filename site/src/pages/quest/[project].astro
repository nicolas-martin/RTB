---
import BaseLayout from '../../layouts/BaseLayout.astro';
import SiteHeader from '../../components/SiteHeader.astro';
import QuestApp from '../../components/QuestApp';

export async function getStaticPaths() {
  // Define the available quest projects
  const projects = ['rtb', 'gluex'];
  
  return projects.map(project => ({
    params: { project }
  }));
}

const { project } = Astro.params;
const currentPath = Astro.url.pathname;

// Get project info from ecosystem data if available
let projectInfo = null;
try {
  const ecosystemData = await Astro.glob('../../content/ecosystem/*.yaml');
  const plasmaData = ecosystemData.find(data => data.default?.projects);
  
  if (plasmaData?.default?.projects) {
    projectInfo = plasmaData.default.projects.find(p => 
      p.id?.toLowerCase() === project?.toLowerCase() || 
      p.name?.toLowerCase() === project?.toLowerCase()
    );
  }
} catch (error) {
  console.warn('Could not load ecosystem data for project info:', error);
}
---

<BaseLayout title={`${project?.toUpperCase()} Quests`} description={`Track your progress on ${project?.toUpperCase()} quests.`}>
  <SiteHeader slot="header" currentPath={currentPath} />
  <QuestApp projectId={project} projectInfo={projectInfo} client:load />
</BaseLayout>
